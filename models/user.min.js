(function(){var r,n,t,u,f,i;i=require("mongoose"),r=i.Schema,u=require("../config"),f=console.log,t=new r({name:{type:String,index:!0},login:{type:String,unique:!0},password:{type:String},email:{type:String,unique:!0},url:{type:String},profile_image_url:{type:String},location:{type:String},signature:{type:String},profile:{type:String},avatar:{type:String},score:{type:Number,"default":0},topic_count:{type:Number,"default":0},reply_count:{type:Number,"default":0},follower_count:{type:Number,"default":0},following_count:{type:Number,"default":0},collect_tag_count:{type:Number,"default":0},collect_topic_count:{type:Number,"default":0},create_at:{type:Date,"default":Date.now},update_at:{type:Date,"default":Date.now},is_star:{type:Boolean},level:{type:String},active:{type:Boolean,"default":!0},receive_reply_mail:{type:Boolean,"default":!1},receive_at_mail:{type:Boolean,"default":!1},from_wp:{type:Boolean},retrieve_time:{type:Number},retrieve_key:{type:String}}),t.virtual("avatar_url").get(function(){var n;return n=""+(this.profile_image_url||this.avatar||u.site_static_host)+"/public/images/user_icon&48.png",n.replace("http://www.gravatar.com/","http://gravatar.qiniudn.com/")}),n=i.model("User",t),n.getUsersByNames=function(t,i){return t.length===0?i(null,[]):n.find({name:{$in:t}},i)},n.getUserByLogin=function(t,i){return n.findOne({login:t},i)},n.getUserById=function(t,i){return n.findOne({_id:t},i)},n.getUserByName=function(t,i){return n.findOne({name:t},i)},n.getUserByMail=function(t,i){return n.findOne({email:t},i)},n.getUsersByIds=function(t,i){return n.find({_id:{$in:t}},i)},n.getUsersByQuery=function(t,i,r){return n.find(t,[],i,r)},n.getUserByQuery=function(t,i,r){return n.findOne(t,[],i,r)},module.exports=n}).call(this)